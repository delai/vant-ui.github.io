import{d as P,c as N,s as R,l as b,a as U}from"./use-translate-113fec30.js";import{B as v}from"./index-a1b4019d.js";import{A as V,y as g,H as D,M as z,e as o,o as w,a as L,w as h,C as l,c as M,f as F,F as H,r as I}from"./vue-libs-12a1683e.js";import{m as S,a as X,w as Y}from"./with-install-a70dfb01.js";import{V as j}from"./index-01a8c03b.js";import{s as A}from"./function-call-39d5afc9.js";import"./use-route-3942a82f.js";import"./index-b61a6a2b.js";import"./index-a6be55ae.js";import"./index-ae779a94.js";import"./constant-a81ffd37.js";import"./mount-component-8e763b0d.js";import"./use-expose-89a7ef05.js";import"./index-1046b10f.js";import"./use-touch-e98b6450.js";import"./use-lazy-render-8625b066.js";import"./on-popup-reopen-eee79bbb.js";import"./index-05a80ec9.js";import"./interceptor-8283b88e.js";const[J,d,_]=N("signature"),$={tips:String,type:S("png"),penColor:S("#000"),lineWidth:X(3),clearButtonText:String,confirmButtonText:String},q=()=>{var a;const n=document.createElement("canvas");return!!((a=n.getContext)!=null&&a.call(n,"2d"))},G=V({name:J,props:$,emits:["submit","clear","start","end","signing"],setup(n,{emit:a}){const r=g(),c=g(),t=D({width:0,height:0,ctx:null});let i;const p=P?q():!0,u=()=>{if(!t.ctx)return!1;t.ctx.beginPath(),t.ctx.lineWidth=n.lineWidth,t.ctx.strokeStyle=n.penColor,i=R(r),a("start")},k=e=>{var x,C;if(!t.ctx)return!1;b(e);const s=e.touches[0],m=s.clientX-((i==null?void 0:i.left)||0),E=s.clientY-((i==null?void 0:i.top)||0);t.ctx.lineCap="round",t.ctx.lineJoin="round",(x=t.ctx)==null||x.lineTo(m,E),(C=t.ctx)==null||C.stroke(),a("signing",e)},y=e=>{b(e),a("end")},B=e=>{const s=document.createElement("canvas");return s.width=e.width,s.height=e.height,e.toDataURL()===s.toDataURL()},T=()=>{const e=r.value;if(!e)return;const m=B(e)?"":e.toDataURL(`image/${n.type}`,n.type==="jpg"?.9:null);a("submit",{image:m,canvas:e})},W=()=>{t.ctx&&(t.ctx.clearRect(0,0,t.width,t.height),t.ctx.closePath()),a("clear")};return z(()=>{var e,s,m;p&&(t.ctx=(e=r.value)==null?void 0:e.getContext("2d"),t.width=((s=c.value)==null?void 0:s.offsetWidth)||0,t.height=((m=c.value)==null?void 0:m.offsetHeight)||0)}),()=>o("div",{class:d()},[o("div",{class:d("content"),ref:c},[p?o("canvas",{ref:r,width:t.width,height:t.height,onTouchstartPassive:u,onTouchmove:k,onTouchend:y},null):o("p",null,[n.tips])]),o("div",{class:d("footer")},[o(v,{size:"small",onClick:W},{default:()=>[n.clearButtonText||_("clear")]}),o(v,{type:"primary",size:"small",onClick:T},{default:()=>[n.confirmButtonText||_("confirm")]})])])}}),K=Y(G),f=K,gt={__name:"index",setup(n){const a=U({"zh-CN":{basic:"基础用法",penColor:"自定义颜色",lineWidth:"自定义线宽"},"en-US":{basic:"basic",penColor:"penColor",lineWidth:"lineWidth"}}),r=g(""),c=i=>{r.value=i.image},t=()=>A("clear");return(i,p)=>{const u=I("demo-block");return w(),L(H,null,[o(u,{title:l(a)("basic")},{default:h(()=>[o(l(f),{onSubmit:c,onClear:t})]),_:1},8,["title"]),r.value?(w(),M(l(j),{key:0,src:r.value},null,8,["src"])):F("",!0),o(u,{title:l(a)("penColor")},{default:h(()=>[o(l(f),{"pen-color":"#ff0000",onClear:t,onSubmit:c})]),_:1},8,["title"]),o(u,{title:l(a)("lineWidth")},{default:h(()=>[o(l(f),{"line-width":6,onClear:t,onSubmit:c})]),_:1},8,["title"])],64)}}};export{gt as default};
