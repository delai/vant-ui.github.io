import{d as W,c as N,s as R,l as _,a as U}from"./use-translate-39135fb9.js";import{B as w}from"./index-23b805f5.js";import{A as V,y as S,H as D,M as z,e as n,o as k,a as L,w as p,C as u,c as M,f as F,F as H,r as I}from"./vue-libs-12a1683e.js";import{m as y,a as X,w as Y}from"./with-install-7837298d.js";import{V as j}from"./index-7124aca2.js";import"./use-route-3942a82f.js";import"./index-c9bd20fd.js";import"./index-06016b14.js";import"./index-0ebb81d0.js";import"./constant-a81ffd37.js";const[A,x,B]=N("signature"),J={tips:String,type:y("png"),penColor:y("#000"),lineWidth:X(3),cancelButtonText:String,confirmButtonText:String},$=()=>{var a;const o=document.createElement("canvas");return!!((a=o.getContext)!=null&&a.call(o,"2d"))},q=V({name:A,props:J,emits:["submit","clear","start","end","signing"],setup(o,{emit:a}){const c=S(),l=S(),t=D({width:0,height:0,ctx:null});let i;const m=W?$():!0,g=()=>{if(!t.ctx)return!1;t.ctx.beginPath(),t.ctx.lineWidth=o.lineWidth,t.ctx.strokeStyle=o.penColor,i=R(c),a("start")},d=e=>{var v,b;if(!t.ctx)return!1;_(e);const s=e.touches[0],h=s.clientX-((i==null?void 0:i.left)||0),P=s.clientY-((i==null?void 0:i.top)||0);t.ctx.lineCap="round",t.ctx.lineJoin="round",(v=t.ctx)==null||v.lineTo(h,P),(b=t.ctx)==null||b.stroke(),a("signing",e)},f=e=>{_(e),a("end")},r=e=>{const s=document.createElement("canvas");return s.width=e.width,s.height=e.height,e.toDataURL()===s.toDataURL()},E=()=>{const e=c.value;if(!e)return;const s=r(e),h=s?"":e.toDataURL(`image/${o.type}`,o.type==="jpg"?.9:null);a("submit",{canvas:s?null:e,filePath:h})},T=()=>{t.ctx&&(t.ctx.clearRect(0,0,t.width,t.height),t.ctx.closePath()),a("clear")};return z(()=>{var e,s,h;m&&(t.ctx=(e=c.value)==null?void 0:e.getContext("2d"),t.width=((s=l.value)==null?void 0:s.offsetWidth)||0,t.height=((h=l.value)==null?void 0:h.offsetHeight)||0)}),()=>n("div",{class:x()},[n("div",{class:x("content"),ref:l},[m?n("canvas",{ref:c,width:t.width,height:t.height,onTouchstartPassive:g,onTouchmove:d,onTouchend:f},null):n("p",null,[o.tips])]),n("div",{class:x("footer")},[n(w,{size:"small",onClick:T},{default:()=>[o.cancelButtonText||B("cancel")]}),n(w,{type:"primary",size:"small",onClick:E},{default:()=>[o.confirmButtonText||B("confirm")]})])])}}),G=Y(q),C=G,it={__name:"index",setup(o){const a=U({"zh-CN":{basic:"基础用法",penColor:"自定义颜色",lineWidth:"自定义线宽"},"en-US":{basic:"basic",penColor:"penColor",lineWidth:"lineWidth"}}),c=S(""),l=d=>{const{filePath:f,canvas:r}=d;c.value=f,console.log("submit",r,f)},t=()=>console.log("start"),i=()=>console.log("clear"),m=()=>console.log("end"),g=d=>console.log("signing",d);return(d,f)=>{const r=I("demo-block");return k(),L(H,null,[n(r,{title:u(a)("basic")},{default:p(()=>[n(u(C),{onSubmit:l,onClear:i,onStart:t,onEnd:m,onSigning:g})]),_:1},8,["title"]),c.value?(k(),M(u(j),{key:0,src:c.value},null,8,["src"])):F("",!0),n(r,{title:u(a)("penColor")},{default:p(()=>[n(u(C),{"pen-color":"#ff0000",onClear:i,onSubmit:l,onStart:t,onEnd:m,onSigning:g})]),_:1},8,["title"]),n(r,{title:u(a)("lineWidth")},{default:p(()=>[n(u(C),{"line-width":6,onClear:i,onSubmit:l,onStart:t,onEnd:m,onSigning:g})]),_:1},8,["title"])],64)}}};export{it as default};
