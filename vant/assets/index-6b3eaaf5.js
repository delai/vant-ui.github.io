import{A as Y,y as v,D as F,M as q,q as N,u as z,J as E,L,j as R,v as $,e as d,S as H,Q as J,o as h,c as y,w as p,C as l,d as k,t as g,f as w}from"./vue-libs-dcfba01b.js";import{w as M,o as C,h as j,m as Q,c as W,q as G,p as D,a as K}from"./use-translate-00443182.js";import{u as Z}from"./use-touch-d246739c.js";import{V as ee}from"./index-b2bd89b1.js";import{c as O}from"./closest-17b2cc6c.js";import{m as te,a as ae,w as oe}from"./with-install-dbef9c21.js";import{V as S,b as ie}from"./index-1bd301b4.js";import{s as P}from"./function-call-78e38fb1.js";import"./constant-ee6e27d7.js";import"./index-de8b7548.js";import"./use-id-2757e8c9.js";import"./use-expose-0d8d1cf9.js";import"./use-route-dfd2aa0a.js";import"./index-3387156f.js";import"./on-popup-reopen-f7cdcc35.js";import"./use-refs-041b217f.js";import"./index-73d705a7.js";import"./interceptor-85295833.js";import"./mount-component-1e01ff48.js";import"./index-517d7c97.js";import"./use-lock-scroll-089554f3.js";import"./use-lazy-render-ac91aad5.js";import"./index-466fc7b5.js";import"./index-50f1a2e4.js";function le(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!J(t)}const ne={axis:te("y"),magnetic:String,icon:String,gap:ae(24),offset:{type:Object,default:()=>({x:-1,y:-1})},teleport:{type:[String,Object],default:"body"}},[se,X]=W("floating-bubble"),ce=Y({name:se,props:ne,emits:["click","update:offset","offsetChange"],setup(t,{slots:n,emit:r}){const x=v(),a=v({x:0,y:0,width:0,height:0}),i=F(()=>({top:t.gap,right:M.value-a.value.height-t.gap,bottom:C.value-a.value.width-t.gap,left:t.gap})),s=v(!1);let c=!1;const m=F(()=>{const e={},f=j(a.value.x),o=j(a.value.y);return e.transform=`translate3d(${f}, ${o}, 0)`,(s.value||!c)&&(e.transition="none"),e}),V=()=>{const{width:e,height:f}=G(x.value),{offset:o}=t;a.value={x:o.x>-1?o.x:M.value-e-t.gap,y:o.y>-1?o.y:C.value-f-t.gap,width:e,height:f}},u=Z();let b=0,T=0;const A=e=>{u.start(e),s.value=!0,b=a.value.x,T=a.value.y};Q("touchmove",e=>{if(e.preventDefault(),u.move(e),t.axis!=="lock"&&!u.isTap.value){if(t.axis==="x"||t.axis==="xy"){let o=b+u.deltaX.value;o<i.value.left&&(o=i.value.left),o>i.value.right&&(o=i.value.right),a.value.x=o}if(t.axis==="y"||t.axis==="xy"){let o=T+u.deltaY.value;o<i.value.top&&(o=i.value.top),o>i.value.bottom&&(o=i.value.bottom),a.value.y=o}const f=D(a.value,["x","y"]);r("update:offset",f)}},{target:x});const U=()=>{s.value=!1,N(()=>{if(t.magnetic==="x"){const e=O([i.value.left,i.value.right],a.value.x);a.value.x=e}if(t.magnetic==="y"){const e=O([i.value.top,i.value.bottom],a.value.y);a.value.y=e}if(!u.isTap.value){const e=D(a.value,["x","y"]);r("update:offset",e),(b!==e.x||T!==e.y)&&r("offsetChange",e)}})},I=e=>{u.isTap.value&&r("click",e)};q(()=>{V(),N(()=>{c=!0})}),z([M,C,()=>t.gap,()=>t.offset],()=>V(),{deep:!0});const _=v(!0);return E(()=>{_.value=!0}),L(()=>{t.teleport&&(_.value=!1)}),()=>{const e=R(d("div",{class:X(),ref:x,onTouchstartPassive:A,onTouchend:U,onTouchcancel:U,onClick:I,style:m.value},[n.default?n.default():d(ee,{name:t.icon,class:X("icon")},null)]),[[$,_.value]]);return t.teleport?d(H,{to:t.teleport},le(e)?e:{default:()=>[e]}):e}}}),ue=oe(ce),B=ue,re={class:"text"},fe={class:"text"},ve={class:"text"},Ye=Y({__name:"index",setup(t){const n=K({"zh-CN":{clickBubble:"点击气泡",freeMagnetic:"自由拖拽和磁吸",vModel:"双向绑定",basicUsageText:"在 x 轴默认位置，允许 y 轴方向拖拽",freeMagneticText:"允许 x 和 y 轴方向拖拽，吸附到 x 轴方向最近一边",vModelText:"使用 offset 控制位置，"},"en-US":{clickBubble:"Click bubble",freeMagnetic:"Free magnetic",vModel:"vModel",basicUsageText:"In the default x position, drag in the y direction is allowed",freeMagneticText:"Allow x and y drags to attach to the nearest side of the x axis",vModelText:"Use offset to control the position,"}}),r=s=>{P(s.x.toFixed(0)+"__"+s.y.toFixed(0))},x=()=>{P(n("clickBubble"))},a=v(0),i=v({x:200,y:400});return(s,c)=>(h(),y(l(ie),{active:a.value,"onUpdate:active":c[1]||(c[1]=m=>a.value=m)},{default:p(()=>[d(l(S),{title:l(n)("basicUsage")},{default:p(()=>[k("p",re,g(l(n)("basicUsageText")),1),a.value===0?(h(),y(l(B),{key:0,icon:"chat",onClick:x})):w("",!0)]),_:1},8,["title"]),d(l(S),{title:l(n)("freeMagnetic")},{default:p(()=>[k("p",fe,g(l(n)("freeMagneticText")),1),a.value===1?(h(),y(l(B),{key:0,icon:"chat",axis:"xy",magnetic:"x",onOffsetChange:r})):w("",!0)]),_:1},8,["title"]),d(l(S),{title:l(n)("vModel")},{default:p(()=>[k("p",ve,g(l(n)("vModelText"))+" x："+g(i.value.x.toFixed(0))+" y: "+g(i.value.y.toFixed(0)),1),a.value===2?(h(),y(l(B),{key:0,icon:"chat",offset:i.value,"onUpdate:offset":c[0]||(c[0]=m=>i.value=m),axis:"xy"},null,8,["offset"])):w("",!0)]),_:1},8,["title"])]),_:1},8,["active"]))}});export{Ye as default};
