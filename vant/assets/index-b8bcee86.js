import{V as x}from"./index-f0897f9f.js";import{A as y,y as v,R as W,u as R,q as b,G as C,e,r as I,o as U,a as B,w as l,d as m,C as a,g as L,t as P,F as S}from"./vue-libs-12a1683e.js";import{e as T,t as j,c as O,a as V}from"./use-translate-f5915e0e.js";import{a as h,c as N,n as p,t as $,m as G,w as H}from"./with-install-e688503b.js";import"./use-route-3942a82f.js";import"./index-f40ec2de.js";import"./index-5106e8af.js";import"./index-57217a11.js";import"./constant-a81ffd37.js";const[E,k]=O("watermark"),X={gapX:h(0),gapY:h(0),image:String,width:h(100),height:h(100),rotate:N(-22),zIndex:p,content:String,opacity:p,fullPage:$,textColor:G("#dcdee0")},Y=y({name:E,props:X,setup(t,{slots:r}){const c=v(),g=v(""),d=v(""),s=()=>{const o={transformOrigin:"center",transform:`rotate(${t.rotate}deg)`},i=()=>t.image&&!r.content?e("image",{href:d.value,x:"0",y:"0",width:t.width,height:t.height,style:o},null):e("foreignObject",{x:"0",y:"0",width:t.width,height:t.height},[e("div",{xmlns:"http://www.w3.org/1999/xhtml",style:o},[r.content?r.content():e("span",{style:{color:t.textColor}},[t.content])])]),n=t.width+t.gapX,u=t.height+t.gapY;return e("svg",{viewBox:`0 0 ${n} ${u}`,width:n,height:u,xmlns:"http://www.w3.org/2000/svg",style:{padding:`0 ${t.gapX}px ${t.gapY}px 0`,opacity:t.opacity}},[i()])},w=o=>{const i=document.createElement("canvas"),n=new Image;n.crossOrigin="anonymous",n.referrerPolicy="no-referrer",n.onload=()=>{i.width=n.naturalWidth,i.height=n.naturalHeight;const u=i.getContext("2d");u==null||u.drawImage(n,0,0),d.value=i.toDataURL()},n.src=o},_=o=>{const i=new Blob([o],{type:"image/svg+xml;charset=utf-8"});return URL.createObjectURL(i)};return W(()=>{t.image&&w(t.image)}),R(()=>[d.value,t.content,t.textColor,t.height,t.width,t.rotate,t.gapX,t.gapY],()=>{b(()=>{c.value&&(g.value&&URL.revokeObjectURL(g.value),g.value=_(c.value.innerHTML))})},{immediate:!0}),C(()=>{g.value&&URL.revokeObjectURL(g.value)}),()=>{const o=T({backgroundImage:`url(${g.value})`},j(t.zIndex));return e("div",{class:k({full:t.fullPage}),style:o},[e("div",{class:k("wrapper"),ref:c},[s()])])}}}),z=H(Y),f=z,D={class:"demo-watermark-wrapper"},M={class:"demo-watermark-wrapper"},F={class:"demo-watermark-wrapper"},q={class:"demo-watermark-wrapper"},A={class:"demo-watermark-wrapper"},Z={class:"demo-watermark-wrapper"},J=m("div",{style:{background:"linear-gradient(45deg, #000 0, #000 50%, #fff 50%)"}},[m("p",{style:{"mix-blend-mode":"difference",color:"#fff"}}," Vant watermark ")],-1),it=y({__name:"index",setup(t){const r=V({"zh-CN":{switch:"切换",customOpacity:"自定义透明度",customGap:"自定义间隔",customImage:"自定义图片",customRotate:"自定义倾斜角度",displayRange:"显示范围",htmlWatermark:"HTML 水印",textWatermark:"文字水印",imageWatermark:"图片水印"},"en-US":{switch:"Switch",customOpacity:"Custom opacity",customGap:"Custom Gap",customRotate:"Custom Rotate",displayRange:"Display Range",htmlWatermark:"HTML Watermark",textWatermark:"Text Watermark",imageWatermark:"Image Watermark"}}),c=v(!1);return(g,d)=>{const s=I("demo-block");return U(),B(S,null,[e(s,{title:a(r)("textWatermark")},{default:l(()=>[m("div",D,[e(a(f),{content:"Vant","full-page":!1})])]),_:1},8,["title"]),e(s,{title:a(r)("imageWatermark")},{default:l(()=>[m("div",M,[e(a(f),{image:"https://fastly.jsdelivr.net/npm/@vant/assets/vant-watermark.png",opacity:"0.2","full-page":!1})])]),_:1},8,["title"]),e(s,{title:a(r)("customGap")},{default:l(()=>[m("div",F,[e(a(f),{image:"https://fastly.jsdelivr.net/npm/@vant/assets/vant-watermark.png","gap-x":30,"gap-y":10,opacity:"0.2","full-page":!1})])]),_:1},8,["title"]),e(s,{title:a(r)("customRotate")},{default:l(()=>[m("div",q,[e(a(f),{image:"https://fastly.jsdelivr.net/npm/@vant/assets/vant-watermark.png",rotate:"22",opacity:"0.2","full-page":!1})])]),_:1},8,["title"]),e(s,{title:a(r)("displayRange")},{default:l(()=>[m("div",A,[e(a(x),{type:"primary",onClick:d[0]||(d[0]=w=>c.value=!c.value)},{default:l(()=>[L(P(a(r)("switch")),1)]),_:1}),e(a(f),{"full-page":c.value,opacity:"0.2",image:"https://fastly.jsdelivr.net/npm/@vant/assets/vant-watermark.png"},null,8,["full-page"])])]),_:1},8,["title"]),e(s,{title:a(r)("htmlWatermark")},{default:l(()=>[m("div",Z,[e(a(f),{width:150,"full-page":!1},{content:l(()=>[J]),_:1})])]),_:1},8,["title"])],64)}}});export{it as default};
