import{c as B,h as f,i as E,d as $}from"./use-translate.a029ce72.js";import{n as d,t as L,m as P,w as D}from"./with-install.1dc27775.js";import{I as j}from"./index.0a9aad73.js";import{A as C,u as m,O as M,D as N,x as R,I as U,M as V,q as z,e as n,j as q,V as A,B as S}from"./vue-libs.d5ee895a.js";const[F,i]=B("image"),O={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:d,height:d,radius:d,lazyLoad:Boolean,iconSize:d,showError:L,errorIcon:P("photo-fail"),iconPrefix:String,showLoading:L,loadingIcon:P("photo")},T=C({name:F,props:O,emits:["load","error"],setup(r,{emit:g,slots:t}){const c=m(!1),o=m(!0),a=m(),{$Lazyload:l}=M().proxy,b=N(()=>{const e={width:f(r.width),height:f(r.height)};return E(r.radius)&&(e.overflow="hidden",e.borderRadius=f(r.radius)),e});R(()=>r.src,()=>{c.value=!1,o.value=!0});const u=e=>{o.value&&(o.value=!1,g("load",e))},h=e=>{c.value=!0,o.value=!1,g("error",e)},v=(e,s,y)=>y?y():n(j,{name:e,size:r.iconSize,class:s,classPrefix:r.iconPrefix},null),x=()=>{if(o.value&&r.showLoading)return n("div",{class:i("loading")},[v(r.loadingIcon,i("loading-icon"),t.loading)]);if(c.value&&r.showError)return n("div",{class:i("error")},[v(r.errorIcon,i("error-icon"),t.error)])},k=()=>{if(c.value||!r.src)return;const e={alt:r.alt,class:i("img"),style:{objectFit:r.fit,objectPosition:r.position}};return r.lazyLoad?q(n("img",S({ref:a},e),null),[[A("lazy"),r.src]]):n("img",S({ref:a,src:r.src,onLoad:u,onError:h},e),null)},I=({el:e})=>{const s=()=>{e===a.value&&o.value&&u()};a.value?s():z(s)},w=({el:e})=>{e===a.value&&!c.value&&h()};return l&&$&&(l.$on("loaded",I),l.$on("error",w),U(()=>{l.$off("loaded",I),l.$off("error",w)})),V(()=>{z(()=>{var e;(e=a.value)!=null&&e.complete&&u()})}),()=>{var e;return n("div",{class:i({round:r.round,block:r.block}),style:b.value},[k(),x(),(e=t.default)==null?void 0:e.call(t)])}}}),K=D(T);export{K as I};
