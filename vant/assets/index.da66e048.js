import{c as k,h as f,i as B,d as E}from"./use-translate.a029ce72.js";import{n as d,t as L,m as P,w as $}from"./with-install.1dc27775.js";import{I as D}from"./index.0a9aad73.js";import{A as j,u as m,O as C,D as M,x as N,I as R,M as U,e as n,j as V,V as q,B as z,q as A}from"./vue-libs.d5ee895a.js";const[F,i]=k("image"),O={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:d,height:d,radius:d,lazyLoad:Boolean,iconSize:d,showError:L,errorIcon:P("photo-fail"),iconPrefix:String,showLoading:L,loadingIcon:P("photo")},T=j({name:F,props:O,emits:["load","error"],setup(r,{emit:g,slots:t}){const c=m(!1),o=m(!0),a=m(),{$Lazyload:l}=C().proxy,S=M(()=>{const e={width:f(r.width),height:f(r.height)};return B(r.radius)&&(e.overflow="hidden",e.borderRadius=f(r.radius)),e});N(()=>r.src,()=>{c.value=!1,o.value=!0});const u=e=>{o.value&&(o.value=!1,g("load",e))},h=e=>{c.value=!0,o.value=!1,g("error",e)},v=(e,s,y)=>y?y():n(D,{name:e,size:r.iconSize,class:s,classPrefix:r.iconPrefix},null),b=()=>{if(o.value&&r.showLoading)return n("div",{class:i("loading")},[v(r.loadingIcon,i("loading-icon"),t.loading)]);if(c.value&&r.showError)return n("div",{class:i("error")},[v(r.errorIcon,i("error-icon"),t.error)])},x=()=>{if(c.value||!r.src)return;const e={alt:r.alt,class:i("img"),style:{objectFit:r.fit,objectPosition:r.position}};return r.lazyLoad?V(n("img",z({ref:a},e),null),[[q("lazy"),r.src]]):n("img",z({ref:a,src:r.src,onLoad:u,onError:h},e),null)},I=({el:e})=>{const s=()=>{e===a.value&&o.value&&u()};a.value?s():A(s)},w=({el:e})=>{e===a.value&&!c.value&&h()};return l&&E&&(l.$on("loaded",I),l.$on("error",w),R(()=>{l.$off("loaded",I),l.$off("error",w)})),U(()=>{var e;(e=a.value)!=null&&e.complete&&u()}),()=>{var e;return n("div",{class:i({round:r.round,block:r.block}),style:S.value},[x(),b(),(e=t.default)==null?void 0:e.call(t)])}}}),K=$(T);export{K as I};
