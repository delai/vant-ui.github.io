var ne=Object.defineProperty,te=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var j=(e,o,a)=>o in e?ne(e,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[o]=a,D=(e,o)=>{for(var a in o||(o={}))se.call(o,a)&&j(e,a,o[a]);if(z)for(var a of z(o))ue.call(o,a)&&j(e,a,o[a]);return e},T=(e,o)=>te(e,ae(o));import{c as U,i as q,V as Y,P as O,G as Z,a as ce}from"./use-translate.fbf36f21.js";import{t as k,b as V,m as E,c as le,w as G,d as ie,a as M}from"./with-install.251697cd.js";import{C as re}from"./index.e9ec9dce.js";import{z as A,e as n,C as p,D as g,x as _,N as de,j as pe,v as me,q as he,r as ge,o as ve,c as Ce,w as J,B as C}from"./vue-libs.bf80eadf.js";import{P as be}from"./index.b25dcbf6.js";import{u as fe}from"./use-refs.1bd4ff6f.js";import{T as xe,a as K}from"./index.187ce2d8.js";import{F as Be}from"./index.c5d91945.js";import{B as Q}from"./index.16d2686f.js";import{C as we}from"./index.fb1f7cb4.js";import{T as ye}from"./function-call.a70e3069.js";import"./use-route.9fd68ea8.js";import"./index.f1bbf430.js";import"./constant.80c6de18.js";import"./interceptor.12fa8767.js";import"./use-expose.8d47dba2.js";import"./use-touch.9de12470.js";import"./use-lazy-render.d79b7d1e.js";import"./on-popup-reopen.e08ee506.js";import"./index.c2caac4e.js";import"./use-id.139c5032.js";import"./index.47538ae0.js";import"./index.1a890101.js";import"./index.d99a07cf.js";import"./Checker.9f9fefc2.js";import"./mount-component.985a4079.js";const[De,W,N]=U("coupon-cell"),Te={title:String,border:k,editable:k,coupons:V(),currency:E("\xA5"),chosenCoupon:le(-1)};function ke({coupons:e,chosenCoupon:o,currency:a}){const u=e[+o];if(u){let t=0;return q(u.value)?{value:t}=u:q(u.denominations)&&(t=u.denominations),`-${a} ${(t/100).toFixed(2)}`}return e.length===0?N("noCoupon"):N("count",e.length)}var Ee=A({name:De,props:Te,setup(e){return()=>{const o=e.coupons[+e.chosenCoupon];return n(re,{class:W(),value:ke(e),title:e.title||N("title"),border:e.border,isLink:e.editable,valueClass:W("value",{selected:o})},null)}}});const $e=G(Ee);function X(e){const o=new Date(e*1e3);return`${o.getFullYear()}.${Y(o.getMonth()+1)}.${Y(o.getDate())}`}const Fe=e=>(e/10).toFixed(e%10===0?0:1),ee=e=>(e/100).toFixed(e%100===0?0:e%10===0?1:2),[Pe,r,R]=U("coupon");var Se=A({name:Pe,props:{chosen:Boolean,coupon:ie(Object),disabled:Boolean,currency:E("\xA5")},setup(e){const o=p(()=>{const{startAt:t,endAt:c}=e.coupon;return`${X(t)} - ${X(c)}`}),a=p(()=>{const{coupon:t,currency:c}=e;if(t.valueDesc)return[t.valueDesc,n("span",null,[t.unitDesc||""])];if(t.denominations){const l=ee(t.denominations);return[n("span",null,[c]),` ${l}`]}return t.discount?R("discount",Fe(t.discount)):""}),u=p(()=>{const t=ee(e.coupon.originCondition||0);return t==="0"?R("unlimited"):R("condition",t)});return()=>{const{chosen:t,coupon:c,disabled:l}=e,h=l&&c.reason||c.description;return n("div",{class:r({disabled:l})},[n("div",{class:r("content")},[n("div",{class:r("head")},[n("h2",{class:r("amount")},[a.value]),n("p",{class:r("condition")},[c.condition||u.value])]),n("div",{class:r("body")},[n("p",{class:r("name")},[c.name]),n("p",{class:r("valid")},[o.value]),!l&&n(we,{class:r("corner"),modelValue:t},null)])]),h&&n("p",{class:r("description")},[h])])}}});const oe=G(Se),[_e,d,x]=U("coupon-list"),Ae="https://img.yzcdn.cn/vant/coupon-empty.png",Ie={code:E(""),coupons:V(),currency:E("\xA5"),showCount:k,emptyImage:E(Ae),chosenCoupon:M(-1),enabledTitle:String,disabledTitle:String,disabledCoupons:V(),showExchangeBar:k,showCloseButton:k,closeButtonText:String,inputPlaceholder:String,exchangeMinLength:M(1),exchangeButtonText:String,displayedCouponIndex:M(-1),exchangeButtonLoading:Boolean,exchangeButtonDisabled:Boolean};var Le=A({name:_e,props:Ie,emits:["change","exchange","update:code"],setup(e,{emit:o,slots:a}){const[u,t]=fe(),c=g(),l=g(),h=g(0),B=g(0),i=g(e.code),$=p(()=>!e.exchangeButtonLoading&&(e.exchangeButtonDisabled||!i.value||i.value.length<e.exchangeMinLength)),F=()=>{const m=Z(c).height,f=Z(l).height+44;B.value=(m>f?m:O.value)-f},I=()=>{o("exchange",i.value),e.code||(i.value="")},P=s=>{he(()=>{var m;return(m=u.value[s])==null?void 0:m.scrollIntoView()})},v=()=>n("div",{class:d("empty")},[n("img",{src:e.emptyImage},null),n("p",null,[x("noCoupon")])]),b=()=>{if(e.showExchangeBar)return n("div",{ref:l,class:d("exchange-bar")},[n(Be,{modelValue:i.value,"onUpdate:modelValue":s=>i.value=s,clearable:!0,border:!1,class:d("field"),placeholder:e.inputPlaceholder||x("placeholder"),maxlength:"20"},null),n(Q,{plain:!0,type:"danger",class:d("exchange"),text:e.exchangeButtonText||x("exchange"),loading:e.exchangeButtonLoading,disabled:$.value,onClick:I},null)])},L=()=>{const{coupons:s}=e,m=e.showCount?` (${s.length})`:"",f=(e.enabledTitle||x("enable"))+m;return n(K,{title:f},{default:()=>{var w;return[n("div",{class:d("list",{"with-bottom":e.showCloseButton}),style:{height:`${B.value}px`}},[s.map((y,H)=>n(oe,{key:y.id,ref:t(H),coupon:y,chosen:H===e.chosenCoupon,currency:e.currency,onClick:()=>o("change",H)},null)),!s.length&&v(),(w=a["list-footer"])==null?void 0:w.call(a)])]}})},S=()=>{const{disabledCoupons:s}=e,m=e.showCount?` (${s.length})`:"",f=(e.disabledTitle||x("disabled"))+m;return n(K,{title:f},{default:()=>{var w;return[n("div",{class:d("list",{"with-bottom":e.showCloseButton}),style:{height:`${B.value}px`}},[s.map(y=>n(oe,{disabled:!0,key:y.id,coupon:y,currency:e.currency},null)),!s.length&&v(),(w=a["disabled-list-footer"])==null?void 0:w.call(a)])]}})};return _(()=>e.code,s=>{i.value=s}),_(O,F),_(i,s=>o("update:code",s)),_(()=>e.displayedCouponIndex,P),de(()=>{F(),P(e.displayedCouponIndex)}),()=>n("div",{ref:c,class:d()},[b(),n(xe,{active:h.value,"onUpdate:active":s=>h.value=s,class:d("tab")},{default:()=>[L(),S()]}),n("div",{class:d("bottom")},[pe(n(Q,{round:!0,block:!0,type:"danger",class:d("close"),text:e.closeButtonText||x("close"),onClick:()=>o("change",-1)},null),[[me,e.showCloseButton]])])])}});const He=G(Le),ro=A({setup(e){const o=ce({"zh-CN":{coupon:{name:"\u4F18\u60E0\u5238\u540D\u79F0",reason:"\u4F18\u60E0\u5238\u4E0D\u53EF\u7528\u539F\u56E0",description:"\u63CF\u8FF0\u4FE1\u606F"},exchange:"\u5151\u6362\u6210\u529F"},"en-US":{coupon:{name:"Coupon name",reason:"Coupon unavailable reason",description:"Description"},exchange:"Success"}}),a=(v=999999)=>String(Math.floor(Math.random()*v)+1),u=g(!1),t=g(-1),c=g([]),l=p(()=>({id:1,condition:`\u65E0\u95E8\u69DB
\u6700\u591A\u4F18\u60E012\u5143`,reason:"",value:150,name:o("coupon.name"),description:o("coupon.description"),startAt:1489104e3,endAt:1514592e3,valueDesc:"1.5",unitDesc:"\u5143"})),h=p(()=>T(D({},l.value),{id:2,value:12,valueDesc:"8.8",unitDesc:"\u6298"})),B=p(()=>T(D({},l.value),{id:3,reason:o("coupon.reason")})),i=p(()=>T(D({},h.value),{valueDesc:"1",unitDesc:"\u6298",id:4,reason:o("coupon.reason")})),$=p(()=>[l.value,h.value,...c.value]),F=p(()=>[B.value,i.value]),I=v=>{u.value=!1,t.value=v},P=()=>{ye(o("exchange")),c.value.push(T(D({},l.value),{id:a()}))};return(v,b)=>{const L=ge("demo-block");return ve(),Ce(L,{title:C(o)("basicUsage")},{default:J(()=>[n(C($e),{coupons:C($),"chosen-coupon":t.value,onClick:b[0]||(b[0]=S=>u.value=!0)},null,8,["coupons","chosen-coupon"]),n(C(be),{show:u.value,"onUpdate:show":b[1]||(b[1]=S=>u.value=S),round:"",position:"bottom",style:{height:"90%","padding-top":"4px"}},{default:J(()=>[n(C(He),{coupons:C($),"chosen-coupon":t.value,"disabled-coupons":C(F),onChange:I,onExchange:P},null,8,["coupons","chosen-coupon","disabled-coupons"])]),_:1},8,["show"])]),_:1},8,["title"])}}});export{ro as default};
