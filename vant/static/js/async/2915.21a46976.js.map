{"version":3,"file":"static/js/async/2915.21a46976.js","sources":["../../../node_modules/.pnpm/vue-loader@17.3.1_vue@3.3.4_webpack@5.89.0/node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!../../vant/src/barrage/demo/index.vue","../../vant/src/barrage/demo/index.vue","../../vant/src/barrage/Barrage.tsx","../../vant/src/barrage/index.ts","../../vant/src/composables/use-expose.ts"],"sourcesContent":["import script from \"./index.vue.ts?vue&type=script&setup=true&lang=ts!=!../../../../../node_modules/.pnpm/vue-loader@17.3.1_vue@3.3.4_webpack@5.89.0/node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue.ts?vue&type=script&setup=true&lang=ts!=!../../../../../node_modules/.pnpm/vue-loader@17.3.1_vue@3.3.4_webpack@5.89.0/node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue.less?vue&type=style&index=0&id=3ee407af&lang=less!=!../../../../../node_modules/.pnpm/vue-loader@17.3.1_vue@3.3.4_webpack@5.89.0/node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./index.vue?vue&type=style&index=0&id=3ee407af&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import{defineComponent as _defineComponent}from'vue';import{unref as _unref,createElementVNode as _createElementVNode,withCtx as _withCtx,createVNode as _createVNode,toDisplayString as _toDisplayString,createTextVNode as _createTextVNode,resolveComponent as _resolveComponent,Fragment as _Fragment,openBlock as _openBlock,createElementBlock as _createElementBlock}from\"vue\";const _hoisted_1=/*#__PURE__*/_createElementVNode(\"div\",{class:\"video\"},null,-1);const _hoisted_2=/*#__PURE__*/_createElementVNode(\"div\",{class:\"video\"},null,-1);import VanBarrage from'..';import VanButton from'../../button';import VanSpace from'../../space';import{useTranslate}from'../../../docs/site';import{ref,watch}from'vue';import{useToggle}from'@vant/use';export default/*#__PURE__*/_defineComponent({__name:'index',setup(__props){const t=useTranslate({'zh-CN':{barrage:'弹幕',play:'开始',pause:'暂停',videoBarrage:'模仿视频弹幕',lightweight:'轻量',customizable:'可定制的',mobile:'移动端',library:'组件库'},'en-US':{barrage:'barrage',play:'play',pause:'pause',videoBarrage:'Imitate video barrage',lightweight:'Lightweight',customizable:'Customizable',mobile:'Mobile',library:'Library'}});const defaultList=[{id:100,text:t('lightweight')},{id:101,text:t('customizable')},{id:102,text:t('mobile')},{id:103,text:'Vue'},{id:104,text:t('library')},{id:105,text:'VantUI'},{id:106,text:'666'}];const list=ref([...defaultList]);const add=()=>{list.value.push({id:Math.random(),text:'Barrage'});};const videoList=ref([...defaultList]);const videoBarrage=ref();const videoAdd=()=>{videoList.value.push({id:Math.random(),text:'Barrage'});};const[isPlay,toggle]=useToggle(false);watch(isPlay,()=>{if(isPlay.value)videoBarrage.value?.play();else videoBarrage.value?.pause();});return(_ctx,_cache)=>{const _component_demo_block=_resolveComponent(\"demo-block\");return _openBlock(),_createElementBlock(_Fragment,null,[_createVNode(_component_demo_block,{title:_unref(t)('basicUsage')},{default:_withCtx(()=>[_createVNode(_unref(VanBarrage),{modelValue:list.value,\"onUpdate:modelValue\":_cache[0]||(_cache[0]=$event=>list.value=$event)},{default:_withCtx(()=>[_hoisted_1]),_:1},8,[\"modelValue\"]),_createVNode(_unref(VanSpace),{style:{\"margin-top\":\"10px\"}},{default:_withCtx(()=>[_createVNode(_unref(VanButton),{onClick:add,type:\"primary\",size:\"small\"},{default:_withCtx(()=>[_createTextVNode(_toDisplayString(_unref(t)('barrage')),1)]),_:1})]),_:1})]),_:1},8,[\"title\"]),_createVNode(_component_demo_block,{title:_unref(t)('videoBarrage')},{default:_withCtx(()=>[_createVNode(_unref(VanBarrage),{modelValue:videoList.value,\"onUpdate:modelValue\":_cache[1]||(_cache[1]=$event=>videoList.value=$event),ref_key:\"videoBarrage\",ref:videoBarrage,\"auto-play\":false},{default:_withCtx(()=>[_hoisted_2]),_:1},8,[\"modelValue\"]),_createVNode(_unref(VanSpace),{style:{\"margin-top\":\"10px\"}},{default:_withCtx(()=>[_createVNode(_unref(VanButton),{onClick:videoAdd,type:\"primary\",size:\"small\",disabled:!_unref(isPlay)},{default:_withCtx(()=>[_createTextVNode(_toDisplayString(_unref(t)('barrage')),1)]),_:1},8,[\"disabled\"]),_createVNode(_unref(VanButton),{onClick:_cache[2]||(_cache[2]=$event=>_unref(toggle)()),size:\"small\"},{default:_withCtx(()=>[_createTextVNode(_toDisplayString(_unref(isPlay)?_unref(t)('pause'):_unref(t)('play')),1)]),_:1})]),_:1})]),_:1},8,[\"title\"])],64);};}});","import{createVNode as _createVNode}from\"vue\";import{defineComponent,onMounted,ref,nextTick,watch}from'vue';import{useExpose}from'../composables/use-expose';import{createNamespace,makeArrayProp,makeNumberProp,makeNumericProp,truthProp}from'../utils';export const barrageProps={top:makeNumericProp(10),rows:makeNumericProp(4),duration:makeNumericProp(4000),autoPlay:truthProp,delay:makeNumberProp(300),modelValue:makeArrayProp()};const[name,bem]=createNamespace('barrage');export default defineComponent({name,props:barrageProps,emits:['update:modelValue'],setup(props,{emit,slots}){const barrageWrapper=ref();const className=bem('item');const total=ref(0);const barrageItems=[];const createBarrageItem=(text,delay=props.delay)=>{const item=document.createElement('span');item.className=className;item.innerText=String(text);item.style.animationDuration=`${props.duration}ms`;item.style.animationDelay=`${delay}ms`;item.style.animationName='van-barrage';item.style.animationTimingFunction='linear';return item;};const isInitBarrage=ref(true);const isPlay=ref(props.autoPlay);const appendBarrageItem=({id,text},i)=>{const item=createBarrageItem(text,isInitBarrage.value?i*props.delay:undefined);if(!props.autoPlay&&isPlay.value===false){item.style.animationPlayState='paused';}barrageWrapper.value?.append(item);total.value++;const top=(total.value-1)%+props.rows*item.offsetHeight+ +props.top;item.style.top=`${top}px`;item.dataset.id=String(id);barrageItems.push(item);item.addEventListener('animationend',()=>{emit('update:modelValue',[...props.modelValue].filter(v=>String(v.id)!==item.dataset.id));});};const updateBarrages=(newValue,oldValue)=>{const map=new Map(oldValue.map(item=>[item.id,item]));newValue.forEach((item,i)=>{if(map.has(item.id)){map.delete(item.id);}else{// add\nappendBarrageItem(item,i);}});map.forEach(item=>{// remove\nconst index=barrageItems.findIndex(span=>span.dataset.id===String(item.id));if(index>-1){barrageItems[index].remove();barrageItems.splice(index,1);}});isInitBarrage.value=false;};watch(()=>props.modelValue.slice(),(newValue,oldValue)=>updateBarrages(newValue??[],oldValue??[]),{deep:true});const rootStyle=ref({});onMounted(async()=>{rootStyle.value['--move-distance']=`-${barrageWrapper.value?.offsetWidth}px`;await nextTick();updateBarrages(props.modelValue,[]);});const play=()=>{isPlay.value=true;barrageItems.forEach(item=>{item.style.animationPlayState='running';});};const pause=()=>{isPlay.value=false;barrageItems.forEach(item=>{item.style.animationPlayState='paused';});};useExpose({play,pause});return()=>_createVNode(\"div\",{\"class\":bem(),\"ref\":barrageWrapper,\"style\":rootStyle.value},[slots.default?.()]);}});","import{withInstall}from'../utils';import _Barrage from'./Barrage';export const Barrage=withInstall(_Barrage);export default Barrage;export{barrageProps}from'./Barrage';","import{getCurrentInstance}from'vue';import{extend}from'../utils';// expose public api\nexport function useExpose(apis){const instance=getCurrentInstance();if(instance){extend(instance.proxy,apis);}}"],"names":["_hoisted_1","class","_hoisted_2","__name","setup","__props","t","useTranslate","barrage","play","pause","videoBarrage","lightweight","customizable","mobile","library","defaultList","id","text","list","ref","add","value","push","Math","random","videoList","videoAdd","isPlay","toggle","useToggle","watch","_ctx","_cache","_component_demo_block","title","default","modelValue","$event","_","style","onClick","type","size","ref_key","disabled","barrageProps","top","makeNumericProp","rows","duration","autoPlay","truthProp","delay","makeNumberProp","makeArrayProp","name","bem","createNamespace","defineComponent","props","emits","emit","slots","barrageWrapper","className","total","barrageItems","createBarrageItem","item","document","createElement","innerText","String","animationDuration","animationDelay","animationName","animationTimingFunction","isInitBarrage","appendBarrageItem","i","undefined","animationPlayState","append","offsetHeight","dataset","addEventListener","filter","v","updateBarrages","newValue","oldValue","map","Map","forEach","has","delete","index","findIndex","span","remove","splice","slice","deep","rootStyle","onMounted","offsetWidth","nextTick","useExpose","withInstall","apis","instance","getCurrentInstance","extend","proxy"],"mappings":"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"}