import{c as j,i as U,U as q,P as G,r as z,a as ne}from"./use-translate.60ccbb8c.js";import{t as B,b as R,m as S,c as te,w as N,d as ae,a as H}from"./with-install.dc8e3787.js";import{C as se}from"./index.65dbdad3.js";import{A as O,e as n,D as p,x as g,y as $,M as ce,j as ue,v as ie,q as le,r as re,o as de,c as pe,w as Y,C as f}from"./vue-libs.73c42632.js";import{P as me}from"./index.5fab1dc6.js";import{u as he}from"./use-refs.7352ad87.js";import{T as ge,a as Z}from"./index.ddf1d8fa.js";import{E as ve}from"./index.96c7e67b.js";import{F as fe}from"./index.73f8a057.js";import{B as J}from"./index.a602decc.js";import{C as be}from"./index.f3f3c48d.js";import{s as Ce}from"./index.4cd3469b.js";import"./use-route.3f983808.js";import"./index.b51190a6.js";import"./index.642bbd48.js";import"./constant.80c6de18.js";import"./interceptor.fee10c5b.js";import"./use-expose.a60c2de9.js";import"./use-touch.53b51ffa.js";import"./use-lazy-render.0515f8b3.js";import"./on-popup-reopen.3f7ea527.js";import"./index.889c8729.js";import"./use-id.66688fd9.js";import"./index.dad2b25c.js";import"./index.7d43f3bb.js";import"./index.81e89703.js";import"./Checker.6fddeaeb.js";import"./mount-component.cf730ff6.js";const[xe,K,V]=j("coupon-cell"),ye={title:String,border:B,editable:B,coupons:R(),currency:S("\xA5"),chosenCoupon:te(-1)};function we({coupons:e,chosenCoupon:o,currency:a}){const c=e[+o];if(c){let t=0;return U(c.value)?{value:t}=c:U(c.denominations)&&(t=c.denominations),`-${a} ${(t/100).toFixed(2)}`}return e.length===0?V("noCoupon"):V("count",e.length)}const _e=O({name:xe,props:ye,setup(e){return()=>{const o=e.coupons[+e.chosenCoupon];return n(se,{class:K(),value:we(e),title:e.title||V("title"),border:e.border,isLink:e.editable,valueClass:K("value",{selected:o})},null)}}}),Be=N(_e);function Q(e){const o=new Date(e*1e3);return`${o.getFullYear()}.${q(o.getMonth()+1)}.${q(o.getDate())}`}const De=e=>(e/10).toFixed(e%10===0?0:1),W=e=>(e/100).toFixed(e%100===0?0:e%10===0?1:2),[Pe,r,M]=j("coupon"),Te=O({name:Pe,props:{chosen:Boolean,coupon:ae(Object),disabled:Boolean,currency:S("\xA5")},setup(e){const o=p(()=>{const{startAt:t,endAt:u}=e.coupon;return`${Q(t)} - ${Q(u)}`}),a=p(()=>{const{coupon:t,currency:u}=e;if(t.valueDesc)return[t.valueDesc,n("span",null,[t.unitDesc||""])];if(t.denominations){const i=W(t.denominations);return[n("span",null,[u]),` ${i}`]}return t.discount?M("discount",De(t.discount)):""}),c=p(()=>{const t=W(e.coupon.originCondition||0);return t==="0"?M("unlimited"):M("condition",t)});return()=>{const{chosen:t,coupon:u,disabled:i}=e,h=i&&u.reason||u.description;return n("div",{class:r({disabled:i})},[n("div",{class:r("content")},[n("div",{class:r("head")},[n("h2",{class:r("amount")},[a.value]),n("p",{class:r("condition")},[u.condition||c.value])]),n("div",{class:r("body")},[n("p",{class:r("name")},[u.name]),n("p",{class:r("valid")},[o.value]),!i&&n(be,{class:r("corner"),modelValue:t},null)])]),h&&n("p",{class:r("description")},[h])])}}}),X=N(Te),[Ee,d,x]=j("coupon-list"),$e={code:S(""),coupons:R(),currency:S("\xA5"),showCount:B,emptyImage:String,chosenCoupon:H(-1),enabledTitle:String,disabledTitle:String,disabledCoupons:R(),showExchangeBar:B,showCloseButton:B,closeButtonText:String,inputPlaceholder:String,exchangeMinLength:H(1),exchangeButtonText:String,displayedCouponIndex:H(-1),exchangeButtonLoading:Boolean,exchangeButtonDisabled:Boolean},Fe=O({name:Ee,props:$e,emits:["change","exchange","update:code"],setup(e,{emit:o,slots:a}){const[c,t]=he(),u=g(),i=g(),h=g(0),y=g(0),l=g(e.code),D=p(()=>!e.exchangeButtonLoading&&(e.exchangeButtonDisabled||!l.value||l.value.length<e.exchangeMinLength)),P=()=>{const m=z(u).height,C=z(i).height+44;y.value=(m>C?m:G.value)-C},I=()=>{o("exchange",l.value),e.code||(l.value="")},T=s=>{le(()=>{var m;return(m=c.value[s])==null?void 0:m.scrollIntoView()})},v=()=>n(ve,{image:e.emptyImage},{default:()=>[n("p",{class:d("empty-tip")},[x("noCoupon")])]}),b=()=>{if(e.showExchangeBar)return n("div",{ref:i,class:d("exchange-bar")},[n(fe,{modelValue:l.value,"onUpdate:modelValue":s=>l.value=s,clearable:!0,border:!1,class:d("field"),placeholder:e.inputPlaceholder||x("placeholder"),maxlength:"20"},null),n(J,{plain:!0,type:"primary",class:d("exchange"),text:e.exchangeButtonText||x("exchange"),loading:e.exchangeButtonLoading,disabled:D.value,onClick:I},null)])},A=()=>{const{coupons:s}=e,m=e.showCount?` (${s.length})`:"",C=(e.enabledTitle||x("enable"))+m;return n(Z,{title:C},{default:()=>{var w;return[n("div",{class:d("list",{"with-bottom":e.showCloseButton}),style:{height:`${y.value}px`}},[s.map((_,L)=>n(X,{key:_.id,ref:t(L),coupon:_,chosen:L===e.chosenCoupon,currency:e.currency,onClick:()=>o("change",L)},null)),!s.length&&v(),(w=a["list-footer"])==null?void 0:w.call(a)])]}})},E=()=>{const{disabledCoupons:s}=e,m=e.showCount?` (${s.length})`:"",C=(e.disabledTitle||x("disabled"))+m;return n(Z,{title:C},{default:()=>{var w;return[n("div",{class:d("list",{"with-bottom":e.showCloseButton}),style:{height:`${y.value}px`}},[s.map(_=>n(X,{disabled:!0,key:_.id,coupon:_,currency:e.currency},null)),!s.length&&v(),(w=a["disabled-list-footer"])==null?void 0:w.call(a)])]}})};return $(()=>e.code,s=>{l.value=s}),$(G,P),$(l,s=>o("update:code",s)),$(()=>e.displayedCouponIndex,T),ce(()=>{P(),T(e.displayedCouponIndex)}),()=>n("div",{ref:u,class:d()},[b(),n(ge,{active:h.value,"onUpdate:active":s=>h.value=s,class:d("tab")},{default:()=>[A(),E()]}),n("div",{class:d("bottom")},[ue(n(J,{round:!0,block:!0,type:"primary",class:d("close"),text:e.closeButtonText||x("close"),onClick:()=>o("change",-1)},null),[[ie,e.showCloseButton]])])])}}),ke=N(Fe);var Se=Object.defineProperty,Oe=Object.defineProperties,Ie=Object.getOwnPropertyDescriptors,ee=Object.getOwnPropertySymbols,Ae=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable,oe=(e,o,a)=>o in e?Se(e,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[o]=a,F=(e,o)=>{for(var a in o||(o={}))Ae.call(o,a)&&oe(e,a,o[a]);if(ee)for(var a of ee(o))Le.call(o,a)&&oe(e,a,o[a]);return e},k=(e,o)=>Oe(e,Ie(o));const po=O({__name:"index",setup(e){const o=ne({"zh-CN":{coupon:{name:"\u4F18\u60E0\u5238\u540D\u79F0",reason:"\u4F18\u60E0\u5238\u4E0D\u53EF\u7528\u539F\u56E0",description:"\u63CF\u8FF0\u4FE1\u606F"},exchange:"\u5151\u6362\u6210\u529F"},"en-US":{coupon:{name:"Coupon name",reason:"Coupon unavailable reason",description:"Description"},exchange:"Success"}}),a=(v=999999)=>String(Math.floor(Math.random()*v)+1),c=g(!1),t=g(-1),u=g([]),i=p(()=>({id:1,condition:`\u65E0\u95E8\u69DB
\u6700\u591A\u4F18\u60E012\u5143`,reason:"",value:150,name:o("coupon.name"),description:o("coupon.description"),startAt:1489104e3,endAt:1514592e3,valueDesc:"1.5",unitDesc:"\u5143"})),h=p(()=>k(F({},i.value),{id:2,value:12,valueDesc:"8.8",unitDesc:"\u6298"})),y=p(()=>k(F({},i.value),{id:3,reason:o("coupon.reason")})),l=p(()=>k(F({},h.value),{valueDesc:"1",unitDesc:"\u6298",id:4,reason:o("coupon.reason")})),D=p(()=>[i.value,h.value,...u.value]),P=p(()=>[y.value,l.value]),I=v=>{c.value=!1,t.value=v},T=()=>{Ce(o("exchange")),u.value.push(k(F({},i.value),{id:a()}))};return(v,b)=>{const A=re("demo-block");return de(),pe(A,{title:f(o)("basicUsage")},{default:Y(()=>[n(f(Be),{coupons:f(D),"chosen-coupon":t.value,onClick:b[0]||(b[0]=E=>c.value=!0)},null,8,["coupons","chosen-coupon"]),n(f(me),{show:c.value,"onUpdate:show":b[1]||(b[1]=E=>c.value=E),round:"",position:"bottom",style:{height:"90%","padding-top":"4px"}},{default:Y(()=>[n(f(ke),{coupons:f(D),"chosen-coupon":t.value,"disabled-coupons":f(P),onChange:I,onExchange:T},null,8,["coupons","chosen-coupon","disabled-coupons"])]),_:1},8,["show"])]),_:1},8,["title"])}}});export{po as default};
